#include<bits/stdc++.h>usingnamespacestd;intmain(){ios_base::sync_with_stdio(false);cin.tie(NULL);cout.tie(NULL);longlongt=1;cin>>t;while(t--){intn;cin>>n;intp;vector<int>edge[n+1];intdepth[n+1]={-1};vector<int>oe[n+1];queue<int>q;for(inti=0;i<n;i++){intx,y;cin>>x>>y;edge[y].push_back(x);oe[x].push_back(x);}introot=-1;for(inti=1;i<n+1;i++){if(oe[i].size()=0)root=i;}q.push(root);depth[root]=1000;while(q.empty()==false){intn1=q.front();for(autoi=edge[n1].begin();i!=edge[n1].end();i++){depth[*i]=depth[n1]+1;q.push(i);}}intans=0;for(inti=0;i<n+1;i++)if(depth[i]>ans)ans=depth[i];cout<<ans<<\'\\n\';}return0;}$